<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:mvc="http://www.springframework.org/schema/mvc"
       xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/mvc https://www.springframework.org/schema/mvc/spring-mvc.xsd">

    <mvc:interceptors>

        <!-- 로그인 검증 -->
        <mvc:interceptor>
            <mvc:mapping path="/api/**"/>
            <bean id="AuthenticatedInterceptor"
                  class="com.perfect.community.api.security.interceptor.AuthenticatedInterceptor"/>
        </mvc:interceptor>

        <!-- 대상 객체의 소유자 또는 관리자만이 접근할 수 있는 API 제한 -->
        <mvc:interceptor>
            <mvc:mapping path="/api/user/update/*"/>
            <mvc:mapping path="/api/user/withdraw/*"/>
            <mvc:mapping path="/api/user/verify-password"/>
            <mvc:mapping path="/api/user/enable/*"/>
            <mvc:mapping path="/api/user/disable/*"/>

            <mvc:mapping path="/api/board/update/*"/>
            <mvc:mapping path="/api/board/delete/*"/>

            <mvc:mapping path="/api/post/modify/*"/>
            <mvc:mapping path="/api/post/remove/*"/>

            <bean id="accessDeniedInterceptor"
                  class="com.perfect.community.api.security.interceptor.AccessDeniedInterceptor"/>
        </mvc:interceptor>

        <!-- 관리자만이 접근할 수 있는 API 제한 -->
        <mvc:interceptor>
<!--            <mvc:mapping path="/api"/>-->
<!--            <mvc:mapping path="/api/user"/>-->
            <mvc:mapping path="/api/board/create"/>

            <bean id="onlyAdminAccessInterceptor"
                  class="com.perfect.community.api.security.interceptor.OnlyAdminAccessInterceptor"/>
        </mvc:interceptor>
    </mvc:interceptors>

</beans>